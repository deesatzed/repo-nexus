# RepoNexus — Engineering Handoff Packet (as of 2025-12-19)

## 1. Executive Snapshot (1 page max)

*   **Current development phase**: Active Development & Feature Expansion.
*   **Last stable commit**: `TODO: owner?, due?, source?` (Project is not a git repository).
*   **What is working vs. incomplete**:
    *   **Working**:
        *   GitHub repository fetching and browsing.
        *   AI-powered analysis of individual repositories using the Gemini API.
        *   UI for displaying repository lists, filters, and analysis results.
        *   Client-side caching of analysis results in `localStorage` to prevent re-computation.
        *   Feature to download a `.zip` archive of a repository.
        *   Feature to delete a repository from GitHub with a confirmation dialog.
    *   **Incomplete / Future**:
        *   Cross-repository analysis and insights. This is a planned future enhancement.
*   **“Resume in 1 day?” checklist**:
    *   [ ] Ensure `node` and `npm` are installed.
    *   [ ] Run `npm install` to get all dependencies (`package.json @ TODO: main#TODO: sha? (TODO: date?)`).
    *   [ ] Create `.env.local` and populate `GEMINI_API_KEY` (`.env.local:L1 @ TODO: main#TODO: sha? (TODO: date?)`).
    *   [ ] Run `npm run dev` to start the local server.
    *   [ ] Open the app, navigate to Settings, and provide a GitHub username and a Personal Access Token with `repo` and `delete_repo` scopes.
*   **Active owners**:
    *   **Technical Lead**: `TODO: owner?, due?, source?`
    *   **Product Manager**: `TODO: owner?, due?, source?`
    *   **DevOps**: `TODO: owner?, due?, source?`

---

## 2. Project Specification (What)

*   **Scope & goals**: To provide a user-friendly interface for GitHub repository management and analysis. The application allows users to connect their GitHub account, browse their repositories, and for each repository, trigger an AI-powered analysis that provides a project summary, resume-ready bullet points, and organizational advice. It also provides basic management features like backup (download) and deletion.
*   **Non-goals**:
    *   Real-time collaboration or multi-user support.
    *   Direct integration into a CI/CD pipeline.
    *   Code editing or committing.
*   **Stakeholders and requirements**:
    *   `TODO: owner?, due?, source?` No formal stakeholder or requirements document is available. The primary user is a developer looking to understand and manage their own portfolio of repositories.
*   **Success metrics with current baselines**:
    *   `TODO: owner?, due?, source?` No success metrics are currently defined.

---

## 3. Implementation State (How)

*   **Module/component responsibilities**:
    *   `App.tsx`: The main React component responsible for UI rendering, overall application state management, and orchestrating calls to services. `App.tsx @ TODO: main#TODO: sha? (TODO: date?)`
    *   `services/githubService.ts`: A class-based service that encapsulates all interactions with the GitHub API, including fetching repositories, reading READMEs, and deleting repositories. `services/githubService.ts @ TODO: main#TODO: sha? (TODO: date?)`
    *   `services/geminiService.ts`: A function that handles the call to the Google Gemini API, sending repository metadata and receiving a structured JSON analysis. `services/geminiService.ts @ TODO: main#TODO: sha? (TODO: date?)`
    *   `types.ts`: Contains all shared TypeScript type definitions for objects like `GithubRepo` and `AnalysisResult`. `types.ts @ TODO: main#TODO: sha? (TODO: date?)`
*   **Current strategy and boundaries**: The application is a pure client-side Single-Page Application (SPA). All logic executes within the user's browser. There is no backend server. API credentials for Gemini are loaded at build time, and the GitHub token is stored in the browser's `localStorage`.
*   **Dependency graph**:
    ```
      [ UI (App.tsx) ]
          |
          +--> [ State (React Hooks) ]
          |
          +--> [ services/githubService.ts ] --> [ GitHub REST API ]
          |
          +--> [ services/geminiService.ts ] --> [ Google Gemini API ]
    ```
*   **Open design decisions**:
    *   The primary open decision is the design and implementation of the cross-repository analysis feature. `TODO: owner?, due?, source?`

---

## 4. Architecture & Environments

*   **High-level architecture**:
    *   **Client**: A Vite-powered React/TypeScript Single-Page Application that runs entirely in the browser.
    *   **APIs**: Direct, authenticated calls from the client to the GitHub REST API and the Google Gemini API.
    *   **Storage**: Browser `localStorage` is used for two purposes:
        1.  Persisting the user's GitHub token and username (`gh_token`, `gh_user`).
        2.  Caching `AnalysisResult` objects (`analysis_<repo_id>`) to avoid redundant API calls.
*   **Environment overview**:
    *   **Development**: Local machine only. Started via `npm run dev`.
    *   **QA / Staging / Prod**: Do not exist.
*   **URLs, parity gaps, IaC paths, state backends**: Not applicable.
*   **Networking**: The application runs on `localhost:3000` and makes outbound HTTPS requests to `api.github.com` and Google's AI services on port 443.

---

## 5. Versions & Compatibility

*   **Languages/SDKs**:
    *   TypeScript: `~5.8.2` (`package.json:L16 @ TODO: main#TODO: sha? (TODO: date?)`)
    *   Node.js: `^22.14.0` (as per `@types/node` version in `package.json:L14 @ TODO: main#TODO: sha? (TODO: date?)`)
*   **Frameworks/libraries**:
    *   React: `^19.2.3` (`package.json:L12 @ TODO: main#TODO: sha? (TODO: date?)`)
    *   Vite: `^6.2.0` (`package.json:L17 @ TODO: main#TODO: sha? (TODO: date?)`)
    *   @google/genai: `^1.34.0` (`package.json:L10 @ TODO: main#TODO: sha? (TODO: date?)`)
*   **Container images**: Not applicable.
*   **Datastores**: Browser `localStorage` (unversioned).

---

## 6. Build & Run Guides

### Local Dev Sanity Checklist
*   [ ] `node -v` returns a compatible version.
*   [ ] `npm -v` returns a compatible version.
*   [ ] `.env.local` exists and contains `GEMINI_API_KEY`.
*   [ ] `npm install` has been run successfully.

*   **Local dev setup**:
    1.  Clone or download the project files.
    2.  Create a file named `.env.local` in the root directory.
    3.  Add your Google Gemini API key to this file: `GEMINI_API_KEY=your_key_here`
    4.  Install dependencies:
        ```bash
        npm install
        ```

*   **Build commands**:
    *   To check for TypeScript errors and build for production:
        ```bash
        npm run build
        ```
    *   This generates a `dist` directory with static assets.

*   **Running locally**:
    1.  Execute the following command:
        ```bash
        npm run dev
        ```
    2.  Open a web browser to `http://localhost:3000`.
    3.  Navigate to the "Settings" page in the UI.
    4.  Enter your GitHub Username and a Personal Access Token. The token requires `repo` scope to read repositories and `delete_repo` scope to use the delete functionality.

*   **Common pitfalls**:
    *   Running `npm run dev` before `npm install` will fail with a `vite: command not found` error.
    *   The "Delete" feature will fail if the provided GitHub token does not have the `delete_repo` scope. An error message will be displayed in the UI.
    *   Analysis will fail if the `GEMINI_API_KEY` is missing or invalid.

---

## 7. Deployment & Release

*   **Branching & promotion flow**: `TODO: owner?, due?, source?` (Project is not a git repository).
*   **CI/CD pipelines**: None exist.
*   **Rollback/hotfix procedures**: Not applicable.
*   **Summary of recent releases**: Not applicable.

---

## 8. Configuration, Secrets & Compliance

### Secrets & Compliance Checklist
*   [ ] No secrets are hardcoded in source files.
*   [ ] `.env.local` is listed in `.gitignore` (or equivalent). `TODO: owner?, due?, source?` (.gitignore exists but project is not a git repo).
*   [ ] Client-side secret handling risks are understood and documented.

*   **Config surfaces**:
    *   `GEMINI_API_KEY`: Provided in `.env.local` (`.env.local:L1 @ TODO: main#TODO: sha? (TODO: date?)`) and loaded at build time (`vite.config.ts:L13 @ TODO: main#TODO: sha? (TODO: date?)`).
    *   `GITHUB_TOKEN`: Provided by the user via the in-app Settings UI and stored in browser `localStorage`.
    *   `GITHUB_USERNAME`: Provided by the user via the in-app Settings UI and stored in browser `localStorage`.
*   **Secrets handling patterns**:
    *   **`GEMINI_API_KEY`**: This secret is exposed client-side. The Vite `define` config replaces `process.env.GEMINI_API_KEY` directly in the bundled JavaScript. **This is not a secure practice for a production application** but is acceptable for a local-only tool.
    *   **`GITHUB_TOKEN`**: Stored in `localStorage`, which is standard for client-side applications but is vulnerable to XSS attacks.
*   **SBOM + licenses**: `TODO: owner?, due?, source?` No SBOM is generated. Licenses for dependencies can be inferred from `package.json`.
*   **Data handling requirements**:
    *   Analysis results are stored in `localStorage`, remaining on the user's machine.
    *   No project data is transmitted to any third party except for the necessary API calls to GitHub and Google Gemini.

---

## 9. Testing, QA & Quality Gates

*   **Test coverage snapshot**: `TODO: owner?, due?, source?` No tests exist.
*   **Local test instructions**: No test scripts are defined in `package.json`.
*   **Known flaky tests**: Not applicable.
*   **Linters, SAST/DAST, quality gates**: `package.json` does not contain `lint` scripts or other quality gate configurations.

---

## 10. Observability & Operations

*   **Dashboards, alert rules, SLO/SLA notes**: Not applicable. This is a local-only client-side application. `TODO` if a hosted environment is planned.
*   **Runbooks**: Not applicable.
*   **Recent incidents & remediation summaries**: Not applicable.

---

## 11. Work Stream & Next Steps

*   **Top 5 next steps**:
    1.  **Goal**: Design and implement the cross-repository analysis feature.
        *   **Why now**: This is the next logical evolution of the tool's core value proposition.
        *   **Owner**: `TODO: owner?`
        *   **How**: Read all `analysis_*` keys from `localStorage`, aggregate the JSON data, and send it to a new, specialized Gemini prompt designed for synthesis. Display the results in a new UI view.
        *   **Done when**: A "Portfolio View" or similar is available that shows combined insights.
    2.  **Goal**: Improve UI/UX for destructive actions.
        *   **Why now**: The `window.confirm` for repository deletion is basic and can be accidentally clicked.
        *   **Owner**: `TODO: owner?`
        *   **How**: Replace `window.confirm` with a custom modal that requires the user to type the repository name to confirm deletion (`App.tsx:L123-L132 @ TODO: main#TODO: sha? (TODO: date?)`).
        *   **Done when**: The new confirmation modal is in place.
    3.  **Goal**: Initialize a Git repository and establish a branching strategy.
        *   **Why now**: The project lacks version control, which is critical for stable development.
        *   **Owner**: `TODO: owner?`
        *   **How**: Run `git init`, create an initial commit, and define a simple branching model (e.g., GitFlow or Trunk-Based).
        *   **Done when**: The project is successfully pushed to a remote repository.
    4.  **Goal**: Add a formal testing framework.
        *   **Why now**: To ensure new features do not break existing functionality.
        *   **Owner**: `TODO: owner?`
        *   **How**: Add a testing library like Vitest or React Testing Library. Create a `test` script in `package.json`. Write unit tests for services and components.
        *   **Done when**: Core functions like `handleAnalyze` and `handleDeleteRepo` have unit test coverage.
    5.  **Goal**: Add a "Re-analyze" button for cached results.
        *   **Why now**: Users may want to refresh an analysis if the underlying repository has changed.
        *   **Owner**: `TODO: owner?`
        *   **How**: In the analysis modal, if the data is from cache, show a "Re-analyze" button that clears the cache for that repo (`localStorage.removeItem`) and re-runs `handleAnalyze`.
        *   **Done when**: Users can forcefully refresh a cached analysis.
*   **Blocked items & dependencies**: None.
*   **Risk matrix**:
    *   **Risk**: Accidental repository deletion due to minimal UI safeguards.
    *   **Likelihood × Impact**: Low × High.
    *   **Mitigation**: Implement a "type-to-confirm" modal for the delete action. See "Next Steps".
    *   **Trigger to act**: Now.
*   **Decision log**:
    *   **Decision**: Used `localStorage` for caching analysis results.
    *   **Why**: The application runs entirely client-side, so direct file system access for saving JSON files is not possible. `localStorage` provides the required persistence without needing a backend server.

---

## 12. Appendices

*   **API surfaces**:
    *   **`githubService.ts`**:
        *   `fetchUserRepos(username)`: Gets a list of user repositories.
        *   `fetchRepoReadme(fullName)`: Gets the raw content of a repository's README.
        *   `deleteRepo(fullName)`: Deletes a repository.
    *   **`geminiService.ts`**:
        *   `analyzeRepository(repo, readme)`: Sends repo data to Gemini and returns a structured analysis.
*   **Data model**:
    *   See `types.ts` (`types.ts @ TODO: main#TODO: sha? (TODO: date?)`).
    *   **`GithubRepo`**: `{ id, name, full_name, description, private, html_url, language, updated_at, default_branch }`
    *   **`AnalysisResult`**: `{ projectPulse, resumePoints, forgottenIdeas, reorgAdvice, status, errorDetails, fullReadme }`
    *   **`View`**: `DASHBOARD | REPO_DETAIL | SETTINGS`
*   **Migrations**: Not applicable.
*   **Glossary**:
    *   **Analysis**: The JSON object returned by the Gemini API containing insights about a repository.
    *   **SPA**: Single-Page Application.

---
```json
{
  "project_name": "RepoNexus: AI Repository Architect",
  "pause_date_iso": "2025-12-19",
  "repo_roots": [
    "/Volumes/WS4TB/Git_Repo_Nexus/reponexus_-ai-repository-architect"
  ],
  "default_branch": "TODO: source?",
  "last_stable_commit": {
    "sha": "TODO: source?",
    "date": "TODO: source?",
    "message": "TODO: source? (Project is not a git repository)"
  },
  "modules": [
    {
      "name": "App",
      "path": "App.tsx",
      "owner": "TODO: owner?",
      "status": "green",
      "notes": "Main UI, state management, and orchestration."
    },
    {
      "name": "GithubService",
      "path": "services/githubService.ts",
      "owner": "TODO: owner?",
      "status": "green",
      "notes": "Handles all communication with the GitHub API."
    },
    {
      "name": "GeminiService",
      "path": "services/geminiService.ts",
      "owner": "TODO: owner?",
      "status": "green",
      "notes": "Handles all communication with the Google Gemini API."
    }
  ],
  "versions": {
    "languages": [
      {
        "name": "TypeScript",
        "version": "~5.8.2"
      }
    ],
    "frameworks": [
      {
        "name": "React",
        "version": "^19.2.3"
      },
      {
        "name": "Vite",
        "version": "^6.2.0"
      },
      {
        "name": "@google/genai",
        "version": "^1.34.0"
      }
    ],
    "containers": [],
    "datastores": [
      {
        "engine": "localStorage",
        "version": "N/A",
        "migration_head": "N/A"
      }
    ]
  },
  "ci_cd": {
    "pipelines": [],
    "release_flow": "TODO: source?"
  },
  "environments": [
    {
      "name": "dev",
      "url": "http://localhost:3000",
      "parity_gaps": [
        "This is the only environment."
      ]
    }
  ],
  "observability": {
    "dashboards": [],
    "alerts": []
  },
  "backlog_next_steps": [
    {
      "title": "Design and implement cross-repository analysis",
      "owner": "TODO: owner?",
      "eta_days": 5,
      "risk": "med"
    },
    {
      "title": "Improve UI for destructive actions (delete repo)",
      "owner": "TODO: owner?",
      "eta_days": 1,
      "risk": "low"
    },
    {
      "title": "Initialize Git repository and define branching strategy",
      "owner": "TODO: owner?",
      "eta_days": 1,
      "risk": "low"
    }
  ],
  "risks": [
    {
      "risk": "Accidental repository deletion due to minimal UI safeguards",
      "likelihood": "low",
      "impact": "high",
      "mitigation": "Implement a 'type-to-confirm' modal for deletion."
    },
    {
      "risk": "Secrets (GEMINI_API_KEY) are exposed on the client side",
      "likelihood": "high",
      "impact": "med",
      "mitigation": "Acceptable for local-only tool, but would require a backend proxy if ever deployed."
    }
  ],
  "todos": [
    {
      "item": "Define project owners (TL, PM, DevOps)",
      "owner": "Project Lead",
      "due": "N/A"
    },
    {
      "item": "Define formal requirements and success metrics",
      "owner": "Product Manager",
      "due": "N/A"
    },
    {
      "item": "Create a formal test suite",
      "owner": "Eng Lead",
      "due": "N/A"
    }
  ]
}
```
